full_join(sb_2020_2) %>%
full_join(sb_2020_3) %>%
full_join(sb_2020_4) %>%
mutate(harvest_year = "2020") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_df <- sb_201112_df %>%
full_join(sb_201213_df) %>%
full_join(sb_201314_df) %>%
full_join(sb_201415_df) %>%
full_join(sb_201516_df) %>%
full_join(sb_201617_df) %>%
full_join(sb_201718_df) %>%
full_join(sb_201819_df) %>%
full_join(sb_201920_df)
str(sb_df)  #here we can see that some changes need to be make to the variable classes
sb_df$harvest_year <- as.factor(sb_df$harvest_year)
sb_df$per_scl <- as.numeric(sb_df$per_scl)
sb_df$no_samples <- as.numeric(sb_df$no_samples)
sb_df <-  sb_df %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sb_silo <- sb_df %>% full_join(silo_regions) #note there will be NAs introduced as some years there were no recording/reportings of sclerotia at particular silo points.
sb_silo <-sb_silo %>%
mutate(crop = "Soybean")
sf_silo <- sf_silo %>%
mutate(crop = "Sunflower")
scl_df <- sf_silo %>% full_join(sb_silo) %>%
drop_na(over_th)
str(scl_df)  #here we can see that some changes need to be make to the variable classes
scl_df$harvest_year <- as.factor(scl_df$harvest_year)
scl_df$per_scl <- as.numeric(scl_df$per_scl)
scl_df$no_samples <- as.numeric(scl_df$no_samples)
#Table 1. The number of production regions (n) which participated in sclerotia, produced by Sclerotinia sclerotiorum, recovery determination and prevalence (%) of positive sclerotia recovery from samples between 2011 and 2020.
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(scl_df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
prev = prev %>%
filter(freq >= 1) %>%
mutate(prev = count/total*100) %>%
select(crop, harvest_year, total, prev)
write.csv(prev, "vis/scl_recovery.csv")
#total number of silos
prev %>%
group_by(crop) %>%
summarise(total = sum(total, na.rm = T))
#maximum and mimimum per crop per annum
scl_df %>%
group_by(crop, harvest_year) %>%
summarise(total  = sum(no_samples, na.rm = T)) %>%
summarise(min = min(total, na.rm = T),
max = max(total, na.rm = T))
#min and max prevalence
prev %>%
group_by(crop) %>%
summarise(min = min(prev, na.rm= T),
max = max(prev, na.rm= T))
#Table 2. One-way analysis of variance of sclerotia, produced by Sclerotinia sclerotiorum, percentage recovery from samples collected from soybean and sunflower production regions from 2012 and 2013, respectively.
options(scipen = 999)
#soybean
res.aov.sb <- aov(per_scl ~ harvest_year, data = scl_df %>%
filter(crop =="Soybean"))
summary(res.aov.sb)
#sunflower
res.aov.sf <- aov(per_scl ~ harvest_year, data = scl_df %>%
filter(crop =="Sunflower"))
# Summary of the analysis
summary(res.aov.sf)
ggplot()+
geom_jitter(data = scl_df %>% filter(crop == "Soybean"),
aes(harvest_year, per_scl), colour = "darkgray", alpha = 0.6, width = 0.2)+
geom_col(data = scl_df %>% filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
dplyr::summarise(mean_per = mean(per_scl)),
aes(harvest_year, mean_per), fill = "darkgray", alpha = 0.2, size = 4)+
geom_errorbar(width = 0.1, colour = "grey40",
data = scl_df %>% filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
dplyr::summarise(
n = n(),
sd = sd(per_scl),
se = sd/sqrt(n),
mean_area = mean(per_scl),
lwr_ci = mean_area+ qt(p = 0.025, df = n-1)*se,
upr_ci = mean_area+ qt(p = 0.975, df = n-1)*se),
aes(x = harvest_year, ymin = lwr_ci, ymax = upr_ci))+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
summarise(N = sum(no_samples)),
aes(harvest_year, 0.4, label = N))+
theme_clean(base_size = 12)+
scale_y_continuous(breaks = seq(0,0.6, 0.1))+
scale_x_discrete(limits =  c("2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"))+
labs(
x = "Year",
y = "Sclerotia (%) per soybean sample")
ggsave("vis/recovery_sb.jpeg", units = "cm", width = 20, height = 12, dpi = 600)
ggplot()+
geom_jitter(data = scl_df %>% filter(crop == "Sunflower"),
aes(harvest_year, per_scl), colour = "darkgray", alpha = 0.6, width = 0.2)+
geom_col(data = scl_df %>% filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
dplyr::summarise(mean_per = mean(per_scl)),
aes(harvest_year, mean_per), fill = "darkgray", alpha = 0.2, size = 4)+
geom_errorbar(width = 0.1, colour = "grey40",
data = scl_df %>% filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
dplyr::summarise(
n = n(),
sd = sd(per_scl),
se = sd/sqrt(n),
mean_area = mean(per_scl),
lwr_ci = mean_area+ qt(p = 0.025, df = n-1)*se,
upr_ci = mean_area+ qt(p = 0.975, df = n-1)*se),
aes(x = harvest_year, ymin = lwr_ci, ymax = upr_ci))+
geom_text(data = scl_df %>%
filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
summarise(N = sum(no_samples)),
aes(harvest_year, 4, label = N))+
theme_clean(base_size = 12)+
scale_y_continuous(breaks = seq(0,5, 0.5))+
labs(
x = "Year",
y = "Sclerotia (%) per sunflower sample")
ggsave("vis/recovery_sf.jpeg", units = "cm", width = 20, height = 12, dpi = 600)
#Shape files are extracted and fortified for use in plotting
south_africa <- ne_states(country = "south africa",
returnclass = "sf")
zar_df <- fortify(south_africa)# shape file to dataframe
zar =  zar_df %>%
mutate(name = case_when(name == "KwaZulu-Natal" ~ "KwaZulu Natal",
name != "KwaZulu-Natal" ~ name)) %>%
dplyr::rename(province = name)#relabeling
#soybean
scl_df$group <- factor(scl_df$harvest_year, levels = c("2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"))
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, shape = over_th), alpha = 0.6, size = 2)+
scale_shape_manual(values = c(13, 1, 0))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
ggsave("vis/prod_reg_sb.jpeg", units = "cm", width = 30, height = 15, dpi = 600)
# sunflower
ggplot()+
geom_sf(data = south_africa)+
geom_jitter(data = scl_df %>%
filter(crop == "Sunflower"),
aes(lon, lat, shape = over_th), alpha = 0.6, size = 2)+
scale_shape_manual(values = c(16, 13, 1, 0))+
geom_text(data = scl_df %>%
filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n), fontface = 3)+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~harvest_year, ncol = 4)
ggsave("vis/prod_reg_sf.jpeg", units = "cm", width = 30, height = 15, dpi = 600)
ggplot()+
geom_jitter(data = scl_df %>% filter(crop == "Soybean"),
aes(harvest_year, per_scl), colour = "darkgreen", alpha = 0.6, width = 0.2)+
geom_col(data = scl_df %>% filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
dplyr::summarise(mean_per = mean(per_scl)),
aes(harvest_year, mean_per), fill = "darkgreen", alpha = 0.2, size = 4)+
geom_errorbar(width = 0.1, colour = "darkgreen",
data = scl_df %>% filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
dplyr::summarise(
n = n(),
sd = sd(per_scl),
se = sd/sqrt(n),
mean_area = mean(per_scl),
lwr_ci = mean_area+ qt(p = 0.025, df = n-1)*se,
upr_ci = mean_area+ qt(p = 0.975, df = n-1)*se),
aes(x = harvest_year, ymin = lwr_ci, ymax = upr_ci))+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(harvest_year) %>%
summarise(N = sum(no_samples)),
aes(harvest_year, 0.4, label = N))+
theme_clean(base_size = 12)+
scale_y_continuous(breaks = seq(0,0.6, 0.1))+
scale_x_discrete(limits =  c("2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"))+
labs(
x = "Year",
y = "Sclerotia (%) per soybean sample")
ggsave("vis/recovery_sb.jpeg", units = "cm", width = 20, height = 12, dpi = 600)
ggplot()+
geom_jitter(data = scl_df %>% filter(crop == "Sunflower"),
aes(harvest_year, per_scl), colour = "orange", alpha = 0.6, width = 0.2)+
geom_col(data = scl_df %>% filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
dplyr::summarise(mean_per = mean(per_scl)),
aes(harvest_year, mean_per), fill = "orange", alpha = 0.2, size = 4)+
geom_errorbar(width = 0.1, colour = "orange",
data = scl_df %>% filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
dplyr::summarise(
n = n(),
sd = sd(per_scl),
se = sd/sqrt(n),
mean_area = mean(per_scl),
lwr_ci = mean_area+ qt(p = 0.025, df = n-1)*se,
upr_ci = mean_area+ qt(p = 0.975, df = n-1)*se),
aes(x = harvest_year, ymin = lwr_ci, ymax = upr_ci))+
geom_text(data = scl_df %>%
filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
summarise(N = sum(no_samples)),
aes(harvest_year, 4, label = N))+
theme_clean(base_size = 12)+
scale_y_continuous(breaks = seq(0,5, 0.5))+
labs(
x = "Year",
y = "Sclerotia (%) per sunflower sample")
ggsave("vis/recovery_sf.jpeg", units = "cm", width = 20, height = 12, dpi = 600)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, shape = over_th), alpha = 0.6, size = 2)+
scale_fill_manual(color = c(red, blue, green))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, fill = over_th), alpha = 0.6, size = 2)+
scale_fill_manual(color = c(red, blue, green))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, fill = over_th), alpha = 0.6, size = 2)+
fill_manual(color = c(red, blue, green))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, fill = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c(""red"", ""orange"", ""blue"", ""darkgreen""))+
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, fill = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("red", "orange, blue", "darkgreen"))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("red", "orange, blue", "darkgreen"))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("orange, blue", "darkgreen"))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("orange", "blue", "darkgreen"))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
#Shape files are extracted and fortified for use in plotting
south_africa <- ne_states(country = "south africa",
returnclass = "sf")
zar_df <- fortify(south_africa)# shape file to dataframe
zar =  zar_df %>%
mutate(name = case_when(name == "KwaZulu-Natal" ~ "KwaZulu Natal",
name != "KwaZulu-Natal" ~ name)) %>%
dplyr::rename(province = name)#relabeling
#soybean
scl_df$group <- factor(scl_df$harvest_year, levels = c("2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020"))
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, shape = over_th), alpha = 0.6, size = 2)+
scale_shape_manual(values = c(13, 1, 0))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
shape = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
ggsave("vis/prod_reg_sb.jpeg", units = "cm", width = 30, height = 15, dpi = 600)
#soybean - colour maps for SASPP
ggplot()+
geom_sf(data = south_africa)+
geom_text(data = scl_df %>%
filter(crop == "Soybean") %>%
group_by(group) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n))+
geom_jitter(data = scl_df %>%
filter(crop == "Soybean"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("orange", "blue", "darkgreen"))+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~group, ncol = 5)
ggsave("vis/prod_reg_sb_colour.jpeg", units = "cm", width = 30, height = 15, dpi = 600)
#sunflower- SASPP colour
ggplot()+
geom_sf(data = south_africa)+
geom_jitter(data = scl_df %>%
filter(crop == "Sunflower"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("red","orange", "blue", "darkgreen"))+
geom_text(data = scl_df %>%
filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n), fontface = 3)+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~harvest_year, ncol = 4)
#sunflower- SASPP colour
ggplot()+
geom_sf(data = south_africa)+
geom_jitter(data = scl_df %>%
filter(crop == "Sunflower"),
aes(lon, lat, colour = over_th), alpha = 0.6, size = 2)+
scale_color_manual(values = c("red","orange", "blue", "darkgreen"))+
geom_text(data = scl_df %>%
filter(crop == "Sunflower") %>%
group_by(harvest_year) %>%
summarise(n = n()) %>%
mutate(lon = 30, lat = -34),
aes(lon, lat, label = n), fontface = 3)+
ylim(-35, -22.5) +
xlim(17, 33)+
labs(x = "Longitude",
y = "Latitude",
colour = "Sclerotia thresholds")+
theme_minimal(base_size = 12)+
theme(legend.position = "bottom")+
facet_wrap(~harvest_year, ncol = 4)
ggsave("vis/prod_reg_sf_colour.jpeg", units = "cm", width = 30, height = 15, dpi = 600)
