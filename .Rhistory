no_samples = "No. of samples_scl")
sb_2018_1 %>%
full_join(sb_2018_2) %>%
full_join(sb_2018_3) %>%
full_join(sb_2018_4) %>%
mutate(harvest_year = "2018") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct()
sb_201718_df <- sb_2018_1 %>%
full_join(sb_2018_2) %>%
full_join(sb_2018_3) %>%
full_join(sb_2018_4) %>%
mutate(harvest_year = "2018") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_201718_df
sb_2019_1
sb_2019_4[,2:3]<- lapply(sb_2019_4[,2:3], as.character)
sb_2019_3
#2019
sb_2019_1[,2:7]<- lapply(sb_2019_1[,2:7], as.character)
sb_2019_2[,2:7]<- lapply(sb_2019_2[,2:7], as.character)
sb_2019_3[,2:7]<- lapply(sb_2019_3[,2:7], as.character)
sb_2019_1 %>%
full_join(sb_2019_2) %>%
full_join(sb_2019_3) %>%
full_join(sb_2019_4) %>%
mutate(harvest_year = "2019") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct()
sb_2019_1 %>%
full_join(sb_2019_2) %>%
full_join(sb_2019_3) %>%
mutate(harvest_year = "2019") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct()
sb_201819_df <- sb_2019_1 %>%
full_join(sb_2019_2) %>%
full_join(sb_2019_3) %>%
mutate(harvest_year = "2019") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_201819_df
sb_2020_1
sb_2020_2
sb_2020_3
sb_2020_4
sb_2020_1 %>%
full_join(sb_2020_2) %>%
full_join(sb_2020_3) %>%
full_join(sb_2020_4) %>%
mutate(harvest_year = "2020") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct()
sb_201920_df <- sb_2020_1 %>%
full_join(sb_2020_2) %>%
full_join(sb_2020_3) %>%
full_join(sb_2020_4) %>%
mutate(harvest_year = "2020") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_201920_df
sb_df <- sb_201213_df %>%
full_join(sb_201314_df) %>%
full_join(sb_201415_df) %>%
full_join(sb_201516_df) %>%
full_join(sb_201617_df) %>%
full_join(sb_201718_df) %>%
full_join(sb_201819_df) %>%
full_join(sb_201920_df) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sb_df
sb_201213_df
sb_201314_df
sb_2014_5
sb_2013_4
sb_201213_df
sb_201314_df
sb_2014_1 %>%
full_join(sb_2014_2) %>%
full_join(sb_2014_3) %>%
full_join(sb_2014_4) %>%
full_join(sb_2014_5) %>%
mutate(harvest_year = "2014") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct()
sb_201314_df <- sb_2014_1 %>%
full_join(sb_2014_2) %>%
full_join(sb_2014_3) %>%
full_join(sb_2014_4) %>%
full_join(sb_2014_5) %>%
mutate(harvest_year = "2014") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:26),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_201314_df
#2012
sb_2012_1[,2:7]<- lapply(sb_2012_1[,2:7], as.character) #sample number name needed to be changed in raw files
sb_2012_2[,2:7]<- lapply(sb_2012_2[,2:7], as.character)
sb_2012_3[,2:7]<- lapply(sb_2012_3[,2:7], as.character)
sb_2012_4[,2:6]<- lapply(sb_2012_4[,2:6], as.character)
sb_201112_df <- sb_2012_1 %>% #10-15
full_join(sb_2012_2) %>% #17-24
full_join(sb_2012_3) %>% #25-30
full_join(sb_2012_4) %>% #31-36
dplyr::mutate(harvest_year = "2012") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%  #seems to be an error here...
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2013
sb_2013_1[,2:7]<- lapply(sb_2013_1[,2:7], as.character)
sb_2013_2[,2:7]<- lapply(sb_2013_2[,2:7], as.character)
sb_2013_3[,2:7]<- lapply(sb_2013_3[,2:7], as.character)
sb_2013_4[,2]<- lapply(sb_2013_4[,2], as.character)
sb_201213_df <- sb_2013_1 %>%
full_join(sb_2013_2) %>%
full_join(sb_2013_3) %>%
full_join(sb_2013_4) %>%
mutate(harvest_year = "2013") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2014
sb_2014_1[,2:7]<- lapply(sb_2014_1[,2:7], as.character)
sb_2014_2[,2:7]<- lapply(sb_2014_2[,2:7], as.character)
sb_2014_3[,2:7]<- lapply(sb_2014_3[,2:7], as.character)
sb_2014_4[,2:7]<- lapply(sb_2014_4[,7], as.character)
sb_2014_5[,2]<- lapply(sb_2014_5[,2], as.character)
sb_201314_df <- sb_2014_1 %>%
full_join(sb_2014_2) %>%
full_join(sb_2014_3) %>%
full_join(sb_2014_4) %>%
full_join(sb_2014_5) %>%
mutate(harvest_year = "2014") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:26),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2015
sb_2015_1[,2:7]<- lapply(sb_2015_1[,2:7], as.character)
sb_2015_2[,2:7]<- lapply(sb_2015_2[,2:7], as.character)
sb_2015_3[,2:7]<- lapply(sb_2015_3[,2:7], as.character)
sb_2015_4[,2]<- lapply(sb_2015_4[,2], as.character)
sb_201415_df <- sb_2015_1 %>%
full_join(sb_2015_2) %>%
full_join(sb_2015_3) %>%
full_join(sb_2015_4) %>%
mutate(harvest_year = "2015") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:25),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2016
sb_2016_1[,2:7]<- lapply(sb_2016_1[,2:7], as.character)
sb_2016_2[,2:7]<- lapply(sb_2016_2[,2:7], as.character)
sb_2016_3[,2:7]<- lapply(sb_2016_3[,2:7], as.character)
sb_2016_4[,2:5]<- lapply(sb_2016_4[,2:5], as.character)
sb_201516_df <- sb_2016_1 %>%
full_join(sb_2016_2) %>%
full_join(sb_2016_3) %>%
full_join(sb_2016_4) %>%
mutate(harvest_year = "2016") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:23),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2017
sb_2017_1[,2:7]<- lapply(sb_2017_1[,2:7], as.character)
sb_2017_2[,2:7]<- lapply(sb_2017_2[,2:7], as.character)
sb_2017_3[,2:7]<- lapply(sb_2017_3[,2:7], as.character)
sb_2017_4[,2:3]<- lapply(sb_2017_4[,2:3], as.character)
sb_201617_df <- sb_2017_1 %>%
full_join(sb_2017_2) %>%
full_join(sb_2017_3) %>%
full_join(sb_2017_4) %>%
mutate(harvest_year = "2017") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:21),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2018
sb_2018_1[,2:7]<- lapply(sb_2018_1[,2:7], as.character)
sb_2018_2[,2:7]<- lapply(sb_2018_2[,2:7], as.character)
sb_2018_3[,2:7]<- lapply(sb_2018_3[,2:7], as.character)
sb_2018_4[,2]<- lapply(sb_2018_4[,2], as.character)
sb_201718_df <- sb_2018_1 %>%
full_join(sb_2018_2) %>%
full_join(sb_2018_3) %>%
full_join(sb_2018_4) %>%
mutate(harvest_year = "2018") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2019
sb_2019_1[,2:7]<- lapply(sb_2019_1[,2:7], as.character)
sb_2019_2[,2:7]<- lapply(sb_2019_2[,2:7], as.character)
sb_2019_3[,2:7]<- lapply(sb_2019_3[,2:7], as.character)
sb_201819_df <- sb_2019_1 %>%
full_join(sb_2019_2) %>%
full_join(sb_2019_3) %>%
mutate(harvest_year = "2019") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
#2020
sb_2020_1[,2:7]<- lapply(sb_2020_1[,2:7], as.character)
sb_2020_2[,2:7]<- lapply(sb_2020_2[,2:7], as.character)
sb_2020_3[,2:7]<- lapply(sb_2020_3[,2:7], as.character)
sb_2020_4[,2:6]<- lapply(sb_2020_4[,2:6], as.character)
sb_201920_df <- sb_2020_1 %>%
full_join(sb_2020_2) %>%
full_join(sb_2020_3) %>%
full_join(sb_2020_4) %>%
mutate(harvest_year = "2020") %>%
rename(desc = Region) %>%
filter(desc %in% c("(F) Sclerotia, %", "No. of samples_scl")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "(F) Sclerotia, %",
no_samples = "No. of samples_scl")
sb_df <- sb_201213_df %>%
full_join(sb_201314_df) %>%
full_join(sb_201415_df) %>%
full_join(sb_201516_df) %>%
full_join(sb_201617_df) %>%
full_join(sb_201718_df) %>%
full_join(sb_201819_df) %>%
full_join(sb_201920_df) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sb_df
sb_silo <- sb_df %>% full_join(silo_regions) #note there will be NAs introduced as some years there were no recording/reportings of sclerotia at particular silo points.
sb_silo
sb_silo %>% full_join(sf_silo)
sb_silo$harvest_year <- as.numeric(sb_silo$harvest_year)
sb_silo %>% full_join(sf_silo)
scl_full <- sb_silo %>% full_join(sf_silo)
scl_full
sb_silo$harvest_year <- as.numeric(sb_silo$harvest_year)
sb_silo
sb_silo %>%
mutate(crop = soybean)
sb_silo %>%
mutate(crop = "soybean")
sb_silo <-sb_silo %>%
mutate(crop = "soybean")
sb_silo$harvest_year <- as.numeric(sb_silo$harvest_year)
sb_silo <-sb_silo %>%
mutate(crop = "Soybean")
sf_silo <- sf_silo %>%
mutate(crop = "Sunflower")
scl_df <- sf_silo %>% full_join(sb_silo)
scl_df
scl_df <- sf_silo %>% full_join(sb_silo) %>% filter(!is.na(region))
scl_df
scl_df <- sf_silo %>% full_join(sb_silo) %>%
drop_na(over_th)
scl_df
prev = scl_df %>%
mutate(freq = case_when(sclerotia_percentage > 0 ~ 1,
sclerotia_percentage <= 0 ~ 0)) %>%
group_by(crop, year, freq) %>%
dplyr::summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(sclerotia_percentage > 0 ~ 1,
sclerotia_percentage <= 0 ~ 0)) %>%
group_by(crop, year) %>%
dplyr::summarise(total = n()))
scl_df
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, year, freq) %>%
dplyr::summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, year) %>%
dplyr::summarise(total = n()))
scl_df
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
dplyr::summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
dplyr::summarise(total = n()))
scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
dplyr::summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
dplyr::summarise(total = n()))
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
cl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0))
scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0))
df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n())
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0))
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq)
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n())
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n())
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(df %>%
ungroup() %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0))
df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0))
prev = scl_df %>%
mutate(freq = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year, freq) %>%
summarise(count = n()) %>%
full_join(scl_df %>%
mutate(total = case_when(per_scl > 0 ~ 1,
per_scl <= 0 ~ 0)) %>%
group_by(crop, harvest_year) %>%
summarise(total = n()))
prev = prev %>%
filter(freq >= 1) %>%
mutate(prev = count/total*100) %>%
dplyr::select(crop, harvest_year, total, prev)
prev
