mutate(harvest_year = 2019) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2018
sf_2018_1 %>%
full_join(sf_2018_2) %>%
full_join(sf_2018_3) %>%
full_join(sf_2018_4) %>%
mutate(harvest_year = 2018) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
sf_2018_1 %>%
full_join(sf_2018_2) %>%
full_join(sf_2018_3) %>%
full_join(sf_2018_4) %>%
mutate(harvest_year = 2018) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct()
#2018
sf_2018_1 %>%
full_join(sf_2018_2) %>%
full_join(sf_2018_3) %>%
full_join(sf_2018_4) %>%
mutate(harvest_year = 2018) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2019
sf_2019_1 %>%
full_join(sf_2019_2) %>%
full_join(sf_2019_3) %>%
full_join(sf_2019_4) %>%
mutate(harvest_year = 2019) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2020
sf_2020_1 %>%
full_join(sf_2020_2) %>%
full_join(sf_2020_3) %>%
full_join(sf_2020_4) %>%
mutate(harvest_year = 2020) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
sf_2020_1 %>%
full_join(sf_2020_2) %>%
full_join(sf_2020_3) %>%
full_join(sf_2020_4) %>%
mutate(harvest_year = 2020) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct()
#2020
sf_2020_1 %>%
full_join(sf_2020_2) %>%
full_join(sf_2020_3) %>%
full_join(sf_2020_4) %>%
mutate(harvest_year = 2020) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:21),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2013
sf_201213_df <- sf_2013_1 %>%
full_join(sf_2013_2) %>%
full_join(sf_2013_3) %>%
full_join(sf_2013_4) %>%
mutate(harvest_year = 2013) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:23),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2014
sf_201314_df <- sf_2014_1 %>%
full_join(sf_2014_2) %>%
full_join(sf_2014_3) %>%
full_join(sf_2014_4) %>%
mutate(harvest_year = 2014) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2015
sf_201415_df <- sf_2015_1 %>%
full_join(sf_2015_2) %>%
full_join(sf_2015_3) %>%
full_join(sf_2015_4) %>%
mutate(harvest_year = 2015) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2016
sf_201516_df <- sf_2016_1 %>%
full_join(sf_2016_2) %>%
full_join(sf_2016_3) %>%
mutate(harvest_year = 2016) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2017
sf_201617_df <- sf_2017_1 %>%
full_join(sf_2017_2) %>%
full_join(sf_2017_3) %>%
full_join(sf_2017_4) %>%
mutate(harvest_year = 2017) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2018
sf_201718_df <- sf_2018_1 %>%
full_join(sf_2018_2) %>%
full_join(sf_2018_3) %>%
full_join(sf_2018_4) %>%
mutate(harvest_year = 2018) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2019
sf_201819_df <-sf_2019_1 %>%
full_join(sf_2019_2) %>%
full_join(sf_2019_3) %>%
full_join(sf_2019_4) %>%
mutate(harvest_year = 2019) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2020
sf_201920_df <- sf_2020_1 %>%
full_join(sf_2020_2) %>%
full_join(sf_2020_3) %>%
full_join(sf_2020_4) %>%
mutate(harvest_year = 2020) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:21),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df)
sf_201213_df
sf_201314_df
sf_201415_df
sf_201516_df
sf_201617_df
sf_2017_1 %>%
full_join(sf_2017_2) %>%
full_join(sf_2017_3) %>%
full_join(sf_2017_4) %>%
mutate(harvest_year = 2017) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct()
#2013
sf_201213_df <- sf_2013_1 %>%
full_join(sf_2013_2) %>%
full_join(sf_2013_3) %>%
full_join(sf_2013_4) %>%
mutate(harvest_year = 2013) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:23),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2014
sf_201314_df <- sf_2014_1 %>%
full_join(sf_2014_2) %>%
full_join(sf_2014_3) %>%
full_join(sf_2014_4) %>%
mutate(harvest_year = 2014) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2015
sf_201415_df <- sf_2015_1 %>%
full_join(sf_2015_2) %>%
full_join(sf_2015_3) %>%
full_join(sf_2015_4) %>%
mutate(harvest_year = 2015) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:24),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2016
sf_201516_df <- sf_2016_1 %>%
full_join(sf_2016_2) %>%
full_join(sf_2016_3) %>%
mutate(harvest_year = 2016) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:19),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2017
sf_201617_df <- sf_2017_1 %>%
full_join(sf_2017_2) %>%
full_join(sf_2017_3) %>%
full_join(sf_2017_4) %>%
mutate(harvest_year = 2017) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2018
sf_201718_df <- sf_2018_1 %>%
full_join(sf_2018_2) %>%
full_join(sf_2018_3) %>%
full_join(sf_2018_4) %>%
mutate(harvest_year = 2018) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:20),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2019
sf_201819_df <-sf_2019_1 %>%
full_join(sf_2019_2) %>%
full_join(sf_2019_3) %>%
full_join(sf_2019_4) %>%
mutate(harvest_year = 2019) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:22),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
#2020
sf_201920_df <- sf_2020_1 %>%
full_join(sf_2020_2) %>%
full_join(sf_2020_3) %>%
full_join(sf_2020_4) %>%
mutate(harvest_year = 2020) %>%
rename(desc = Region) %>%
filter(desc %in% c("3. Sclerotia, %", "No. of samples")) %>%
distinct() %>%
pivot_longer(cols = c(2:21),
names_to = "region",
values_to = "per_sclerotia") %>%
pivot_wider(names_from = "desc",
values_from = "per_sclerotia") %>%
rename(per_scl = "3. Sclerotia, %",
no_samples = "No. of samples")
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df)
install.packages(c("gsheet", "psych", "rnaturalearth"))
library(gsheet) #importing data from google drive
library(tidyverse) #data wrangling and manipulation
library(ggthemes) #plot customisation
library(rnaturalearth) #shape file
library(ggpubr) #plot customisation
library(psych) #descriptive statistics
df <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1CQKEHIghYEqX1Qy7aX3F5oc5EvzNA15xtcI8Pd_7r0g/edit#gid=0", "grading") #sclerotia dataframe (df)
reg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1CQKEHIghYEqX1Qy7aX3F5oc5EvzNA15xtcI8Pd_7r0g/edit#gid=1287063361", "regions") #silo latitude and longitude df
reg = reg %>%
rename(region = number) #renaming variable region to number
df %>%
rename(season = year) %>%
mutate(over_th = case_when(sclerotia_percentage == 0 ~ "No sclerotia detected",
sclerotia_percentage > 0 & sclerotia_percentage < 0.2 ~ "Under all thresholds",
sclerotia_percentage >= 0.2 & sclerotia_percentage < 4 ~ "Above SANSOR threshold (0.2%)",
sclerotia_percentage >=4 ~ "Above DAFF threshold (4%)"),
year = case_when(season == "2011_2012" ~ "2012",
season == "2012_2013" ~ "2013",
season == "2013_2014" ~ "2014",
season == "2014_2015" ~ "2015",
season == "2015_2016" ~ "2016",
season == "2016_2017" ~ "2017",
season == "2017_2018" ~ "2018",
season == "2018_2019" ~ "2019")) #year = year of harvest
#now we join the sclerotia df with the silo lat and lon df.
full.df = df %>%
full_join(reg)
full.df
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
reg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1CQKEHIghYEqX1Qy7aX3F5oc5EvzNA15xtcI8Pd_7r0g/edit#gid=1287063361", "regions") #silo latitude and longitude df
reg
reg <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1CQKEHIghYEqX1Qy7aX3F5oc5EvzNA15xtcI8Pd_7r0g/edit#gid=1287063361", "regions") %>%
select(number, lat, lon)#silo latitude and longitude df
reg
silo_regions <- gsheet2tbl("https://docs.google.com/spreadsheets/d/1CQKEHIghYEqX1Qy7aX3F5oc5EvzNA15xtcI8Pd_7r0g/edit#gid=1287063361", "regions") %>%
select(number, lat, lon)#silo latitude and longitude df
write.csv(silo_regions, "data/silo_regions.csv")
silo_regions <- read.csv(silo_regions, "data/silo_regions.csv")
silo_regions <- read.csv(silo_regions, "data/silo_regions.csv")
silo_regions <- read.csv("data/silo_regions.csv")
silo_regions
silo_regions <- read.csv("data/silo_regions.csv") %>% seleect(-X)
silo_regions <- read.csv("data/silo_regions.csv") %>% seleect(-x)
silo_regions <- read.csv("data/silo_regions.csv") %>% select(-X)
silo_regions
silo_regions
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df) %>%
full_join(silo_regions %>%
rename(region = number)) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df) %>%
full_join(silo_regions %>%
rename(region = number)) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sf_201920_df
sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df) %>%
full_join(silo_regions %>%
rename(region = number)) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
silo_regions <- silo_regions %>%
rename(region = number)
silo_regions
silo_regions$region <- as.character(silo_regions$region)
sf_df <- sf_201213_df %>%
full_join(sf_201314_df) %>%
full_join(sf_201415_df) %>%
full_join(sf_201516_df) %>%
full_join(sf_201617_df) %>%
full_join(sf_201718_df) %>%
full_join(sf_201819_df) %>%
full_join(sf_201920_df) %>%
mutate(over_th = case_when(per_scl == 0 ~ "No sclerotia detected",
per_scl > 0 & per_scl < 0.2 ~ "Under all thresholds",
per_scl >= 0.2 & per_scl < 4 ~ "Above SANSOR threshold (0.2%)",
per_scl >=4 ~ "Above DAFF threshold (4%)"))
sf_df %>% full_join(silo_regions)
sf_df
sf_df %>% full_join(silo_regions)
sf_df
